import{S as Ne,i as Ie,s as Le,k as a,q as R,a as y,y as ue,l as r,m as d,r as M,h as l,c as D,z as ie,n as i,b as re,C as e,A as de,H as se,g as fe,d as he,B as pe,E as De,F as Se,u as oe,R as _e,T as Be,w as Te,W as ae}from"../chunks/index.c7fa5583.js";import{p as Ve}from"../chunks/stores.1249a1df.js";import{M as Ae}from"../chunks/Modal.ca3fada1.js";import{P as $e}from"../chunks/pagination.82eda5f1.js";import{a as ne}from"../chunks/alerter.a508b1c7.js";function Ue(s,t,n){const g=s.slice();return g[18]=t[n],g}function Pe(s,t,n){const g=s.slice();return g[21]=t[n],g[22]=t,g[23]=n,g}function ke(s){let t,n,g=s[23]+1+"",I,P,u,E=s[21].username+"",_,B,h,C=s[21].createdAt.toLocaleString()+"",A,U,p,V=s[21].updatedAt.toLocaleString()+"",O,H,z,w,q,o,f,Y,F,J,j,T,v,$;function b(){s[8].call(w,s[22],s[23])}function L(){return s[9](s[21])}return{c(){t=a("tr"),n=a("td"),I=R(g),P=y(),u=a("td"),_=R(E),B=y(),h=a("td"),A=R(C),U=y(),p=a("td"),O=R(V),H=y(),z=a("td"),w=a("input"),q=y(),o=a("td"),f=a("button"),Y=R("Edit"),F=y(),J=a("button"),j=R("Delete"),T=y(),this.h()},l(m){t=r(m,"TR",{});var k=d(t);n=r(k,"TD",{});var W=d(n);I=M(W,g),W.forEach(l),P=D(k),u=r(k,"TD",{});var x=d(u);_=M(x,E),x.forEach(l),B=D(k),h=r(k,"TD",{});var G=d(h);A=M(G,C),G.forEach(l),U=D(k),p=r(k,"TD",{});var N=d(p);O=M(N,V),N.forEach(l),H=D(k),z=r(k,"TD",{});var ee=d(z);w=r(ee,"INPUT",{class:!0,type:!0}),ee.forEach(l),q=D(k),o=r(k,"TD",{});var Z=d(o);f=r(Z,"BUTTON",{class:!0});var c=d(f);Y=M(c,"Edit"),c.forEach(l),F=D(Z),J=r(Z,"BUTTON",{class:!0});var S=d(J);j=M(S,"Delete"),S.forEach(l),Z.forEach(l),T=D(k),k.forEach(l),this.h()},h(){i(w,"class","toggle"),i(w,"type","checkbox"),i(f,"class","btn btn-sm btn-primary"),i(J,"class","btn btn-sm btn-error")},m(m,k){re(m,t,k),e(t,n),e(n,I),e(t,P),e(t,u),e(u,_),e(t,B),e(t,h),e(h,A),e(t,U),e(t,p),e(p,O),e(t,H),e(t,z),e(z,w),w.checked=s[21].isActive,e(t,q),e(t,o),e(o,f),e(f,Y),e(o,F),e(o,J),e(J,j),e(t,T),v||($=[se(w,"change",b),se(f,"click",L)],v=!0)},p(m,k){s=m,k&1&&E!==(E=s[21].username+"")&&oe(_,E),k&1&&C!==(C=s[21].createdAt.toLocaleString()+"")&&oe(A,C),k&1&&V!==(V=s[21].updatedAt.toLocaleString()+"")&&oe(O,V),k&1&&(w.checked=s[21].isActive)},d(m){m&&l(t),v=!1,_e($)}}}function He(s){let t,n,g,I,P,u,E,_,B,h,C,A,U,p,V,O,H,z,w,q,o,f,Y,F,J,j,T,v,$,b;return{c(){t=a("div"),n=a("h1"),g=R("New user"),I=y(),P=a("div"),u=a("label"),E=a("span"),_=R("username"),B=y(),h=a("input"),C=y(),A=a("div"),U=a("label"),p=a("span"),V=R("password"),O=y(),H=a("input"),z=y(),w=a("div"),q=a("label"),o=a("span"),f=R("confirm password"),Y=y(),F=a("input"),J=y(),j=a("div"),T=a("button"),v=R("Create"),this.h()},l(L){t=r(L,"DIV",{class:!0});var m=d(t);n=r(m,"H1",{class:!0});var k=d(n);g=M(k,"New user"),k.forEach(l),I=D(m),P=r(m,"DIV",{class:!0});var W=d(P);u=r(W,"LABEL",{class:!0});var x=d(u);E=r(x,"SPAN",{class:!0});var G=d(E);_=M(G,"username"),G.forEach(l),x.forEach(l),B=D(W),h=r(W,"INPUT",{type:!0,placeholder:!0,class:!0}),W.forEach(l),C=D(m),A=r(m,"DIV",{class:!0});var N=d(A);U=r(N,"LABEL",{class:!0});var ee=d(U);p=r(ee,"SPAN",{class:!0});var Z=d(p);V=M(Z,"password"),Z.forEach(l),ee.forEach(l),O=D(N),H=r(N,"INPUT",{type:!0,placeholder:!0,class:!0}),N.forEach(l),z=D(m),w=r(m,"DIV",{class:!0});var c=d(w);q=r(c,"LABEL",{class:!0});var S=d(q);o=r(S,"SPAN",{class:!0});var X=d(o);f=M(X,"confirm password"),X.forEach(l),S.forEach(l),Y=D(c),F=r(c,"INPUT",{type:!0,placeholder:!0,class:!0}),c.forEach(l),J=D(m),j=r(m,"DIV",{class:!0});var le=d(j);T=r(le,"BUTTON",{class:!0});var te=d(T);v=M(te,"Create"),te.forEach(l),le.forEach(l),m.forEach(l),this.h()},h(){i(n,"class","text-2xl"),i(E,"class","label-text"),i(u,"class","label"),i(h,"type","text"),i(h,"placeholder","username"),i(h,"class","input input-bordered"),i(P,"class","form-control"),i(p,"class","label-text"),i(U,"class","label"),i(H,"type","password"),i(H,"placeholder","password"),i(H,"class","input input-bordered"),i(A,"class","form-control"),i(o,"class","label-text"),i(q,"class","label"),i(F,"type","password"),i(F,"placeholder","confirm password"),i(F,"class","input input-bordered"),i(w,"class","form-control"),i(T,"class","btn btn-primary"),i(j,"class","form-control mt-6"),i(t,"class","card-body")},m(L,m){re(L,t,m),e(t,n),e(n,g),e(t,I),e(t,P),e(P,u),e(u,E),e(E,_),e(P,B),e(P,h),ae(h,s[4].username),e(t,C),e(t,A),e(A,U),e(U,p),e(p,V),e(A,O),e(A,H),ae(H,s[4].password),e(t,z),e(t,w),e(w,q),e(q,o),e(o,f),e(w,Y),e(w,F),ae(F,s[4].confirmPassword),e(t,J),e(t,j),e(j,T),e(T,v),$||(b=[se(h,"input",s[10]),se(H,"input",s[11]),se(F,"input",s[12]),se(T,"click",s[6])],$=!0)},p(L,m){m&16&&h.value!==L[4].username&&ae(h,L[4].username),m&16&&H.value!==L[4].password&&ae(H,L[4].password),m&16&&F.value!==L[4].confirmPassword&&ae(F,L[4].confirmPassword)},d(L){L&&l(t),$=!1,_e(b)}}}function ye(s){let t,n,g=s[18].name+"",I,P,u,E,_,B,h;function C(...U){return s[15](s[18],...U)}function A(){return s[16](s[18])}return{c(){t=a("label"),n=a("span"),I=R(g),P=y(),u=a("input"),_=y(),this.h()},l(U){t=r(U,"LABEL",{class:!0});var p=d(t);n=r(p,"SPAN",{class:!0});var V=d(n);I=M(V,g),V.forEach(l),P=D(p),u=r(p,"INPUT",{type:!0,class:!0}),_=D(p),p.forEach(l),this.h()},h(){i(n,"class","label-text"),i(u,"type","checkbox"),i(u,"class","checkbox"),u.checked=E=!!s[3].roles.find(C),i(t,"class","label cursor-pointer")},m(U,p){re(U,t,p),e(t,n),e(n,I),e(t,P),e(t,u),e(t,_),B||(h=se(u,"change",A),B=!0)},p(U,p){s=U,p&1&&g!==(g=s[18].name+"")&&oe(I,g),p&9&&E!==(E=!!s[3].roles.find(C))&&(u.checked=E)},d(U){U&&l(t),B=!1,h()}}}function Ce(s){let t,n,g,I=s[3].username+"",P,u,E,_,B,h,C,A,U,p,V,O,H,z,w,q,o,f,Y,F,J,j=s[0].roles,T=[];for(let v=0;v<j.length;v+=1)T[v]=ye(Ue(s,j,v));return{c(){t=a("div"),n=a("h1"),g=R("Edit User @"),P=R(I),u=y(),E=a("div"),_=a("label"),B=a("span"),h=R("username"),C=y(),A=a("input"),U=y(),p=a("div"),V=a("label"),O=a("span"),H=R("Roles"),z=y(),w=a("div");for(let v=0;v<T.length;v+=1)T[v].c();q=y(),o=a("div"),f=a("button"),Y=R("Save"),this.h()},l(v){t=r(v,"DIV",{class:!0});var $=d(t);n=r($,"H1",{class:!0});var b=d(n);g=M(b,"Edit User @"),P=M(b,I),b.forEach(l),u=D($),E=r($,"DIV",{class:!0});var L=d(E);_=r(L,"LABEL",{class:!0});var m=d(_);B=r(m,"SPAN",{class:!0});var k=d(B);h=M(k,"username"),k.forEach(l),m.forEach(l),C=D(L),A=r(L,"INPUT",{type:!0,placeholder:!0,class:!0}),L.forEach(l),U=D($),p=r($,"DIV",{class:!0});var W=d(p);V=r(W,"LABEL",{class:!0});var x=d(V);O=r(x,"SPAN",{class:!0});var G=d(O);H=M(G,"Roles"),G.forEach(l),x.forEach(l),z=D(W),w=r(W,"DIV",{class:!0});var N=d(w);for(let c=0;c<T.length;c+=1)T[c].l(N);N.forEach(l),q=D(W),o=r(W,"DIV",{class:!0});var ee=d(o);f=r(ee,"BUTTON",{class:!0});var Z=d(f);Y=M(Z,"Save"),Z.forEach(l),ee.forEach(l),W.forEach(l),$.forEach(l),this.h()},h(){i(n,"class","text-2xl"),i(B,"class","label-text"),i(_,"class","label"),i(A,"type","text"),i(A,"placeholder","username"),i(A,"class","input input-bordered"),i(E,"class","form-control"),i(O,"class","label-text"),i(V,"class","label"),i(w,"class","flex flex-col flex-wrap"),i(f,"class","btn btn-primary"),i(o,"class","form-control mt-6"),i(p,"class","form-controls"),i(t,"class","card-body")},m(v,$){re(v,t,$),e(t,n),e(n,g),e(n,P),e(t,u),e(t,E),e(E,_),e(_,B),e(B,h),e(E,C),e(E,A),ae(A,s[3].username),e(t,U),e(t,p),e(p,V),e(V,O),e(O,H),e(p,z),e(p,w);for(let b=0;b<T.length;b+=1)T[b]&&T[b].m(w,null);e(p,q),e(p,o),e(o,f),e(f,Y),F||(J=[se(A,"input",s[14]),se(f,"click",s[7])],F=!0)},p(v,$){if($&8&&I!==(I=v[3].username+"")&&oe(P,I),$&8&&A.value!==v[3].username&&ae(A,v[3].username),$&9){j=v[0].roles;let b;for(b=0;b<j.length;b+=1){const L=Ue(v,j,b);T[b]?T[b].p(L,$):(T[b]=ye(L),T[b].c(),T[b].m(w,null))}for(;b<T.length;b+=1)T[b].d(1);T.length=j.length}},d(v){v&&l(t),De(T,v),F=!1,_e(J)}}}function Oe(s){let t,n,g,I,P,u,E,_,B,h,C,A,U,p,V,O,H,z,w,q,o,f,Y,F,J,j,T,v,$,b,L,m,k,W,x;u=new $e({props:{pagination:s[0].pagination,url:s[5].url.href}});let G=s[0].users,N=[];for(let c=0;c<G.length;c+=1)N[c]=ke(Pe(s,G,c));let ee={$$slots:{default:[He]},$$scope:{ctx:s}};b=new Ae({props:ee}),s[13](b);let Z={$$slots:{default:[Ce]},$$scope:{ctx:s}};return m=new Ae({props:Z}),s[17](m),{c(){t=a("div"),n=a("div"),g=a("button"),I=R("Create"),P=y(),ue(u.$$.fragment),E=y(),_=a("table"),B=a("thead"),h=a("tr"),C=a("th"),A=y(),U=a("th"),p=R("Username"),V=y(),O=a("th"),H=R("Created @"),z=y(),w=a("th"),q=R("Updated @"),o=y(),f=a("th"),Y=R("Active"),F=y(),J=a("th"),j=R("Actions"),T=y(),v=a("tbody");for(let c=0;c<N.length;c+=1)N[c].c();$=y(),ue(b.$$.fragment),L=y(),ue(m.$$.fragment),this.h()},l(c){t=r(c,"DIV",{class:!0});var S=d(t);n=r(S,"DIV",{class:!0});var X=d(n);g=r(X,"BUTTON",{class:!0});var le=d(g);I=M(le,"Create"),le.forEach(l),X.forEach(l),P=D(S),ie(u.$$.fragment,S),E=D(S),_=r(S,"TABLE",{class:!0});var te=d(_);B=r(te,"THEAD",{});var K=d(B);h=r(K,"TR",{});var Q=d(h);C=r(Q,"TH",{}),d(C).forEach(l),A=D(Q),U=r(Q,"TH",{});var me=d(U);p=M(me,"Username"),me.forEach(l),V=D(Q),O=r(Q,"TH",{});var ve=d(O);H=M(ve,"Created @"),ve.forEach(l),z=D(Q),w=r(Q,"TH",{});var be=d(w);q=M(be,"Updated @"),be.forEach(l),o=D(Q),f=r(Q,"TH",{});var ge=d(f);Y=M(ge,"Active"),ge.forEach(l),F=D(Q),J=r(Q,"TH",{});var Ee=d(J);j=M(Ee,"Actions"),Ee.forEach(l),Q.forEach(l),K.forEach(l),T=D(te),v=r(te,"TBODY",{});var we=d(v);for(let ce=0;ce<N.length;ce+=1)N[ce].l(we);we.forEach(l),te.forEach(l),S.forEach(l),$=D(c),ie(b.$$.fragment,c),L=D(c),ie(m.$$.fragment,c),this.h()},h(){i(g,"class","btn btn-primary"),i(n,"class","flex flex-row mb-4"),i(_,"class","table table-zebra w-full"),i(t,"class","overflow-x-auto flex flex-col")},m(c,S){re(c,t,S),e(t,n),e(n,g),e(g,I),e(t,P),de(u,t,null),e(t,E),e(t,_),e(_,B),e(B,h),e(h,C),e(h,A),e(h,U),e(U,p),e(h,V),e(h,O),e(O,H),e(h,z),e(h,w),e(w,q),e(h,o),e(h,f),e(f,Y),e(h,F),e(h,J),e(J,j),e(_,T),e(_,v);for(let X=0;X<N.length;X+=1)N[X]&&N[X].m(v,null);re(c,$,S),de(b,c,S),re(c,L,S),de(m,c,S),k=!0,W||(x=se(g,"click",function(){Be(s[1].open)&&s[1].open.apply(this,arguments)}),W=!0)},p(c,[S]){s=c;const X={};if(S&1&&(X.pagination=s[0].pagination),S&32&&(X.url=s[5].url.href),u.$set(X),S&13){G=s[0].users;let K;for(K=0;K<G.length;K+=1){const Q=Pe(s,G,K);N[K]?N[K].p(Q,S):(N[K]=ke(Q),N[K].c(),N[K].m(v,null))}for(;K<N.length;K+=1)N[K].d(1);N.length=G.length}const le={};S&16777232&&(le.$$scope={dirty:S,ctx:s}),b.$set(le);const te={};S&16777225&&(te.$$scope={dirty:S,ctx:s}),m.$set(te)},i(c){k||(fe(u.$$.fragment,c),fe(b.$$.fragment,c),fe(m.$$.fragment,c),k=!0)},o(c){he(u.$$.fragment,c),he(b.$$.fragment,c),he(m.$$.fragment,c),k=!1},d(c){c&&l(t),pe(u),De(N,c),c&&l($),s[13](null),pe(b,c),c&&l(L),s[17](null),pe(m,c),W=!1,x()}}}function Re(s,t,n){let g;Se(s,Ve,o=>n(5,g=o));let I,P,u,{data:E}=t,_={username:"",password:"",confirmPassword:""};async function B(){if(_.password!==_.confirmPassword){ne.update(f=>[...f,{type:"error",message:"Passwords do not match"}]);return}let o=await fetch("/api/users/create",{method:"POST",body:JSON.stringify(_)});o.ok?(console.log(await o.json()),ne.update(f=>[...f,{type:"success",message:"User created"}]),I.close()):ne.update(f=>[...f,{type:"error",message:"Failed to create user"}])}async function h(){let o=await fetch("/api/users/edit",{method:"PATCH",body:JSON.stringify(u)});o.ok?(console.log(await o.json()),ne.update(f=>[...f,{type:"success",message:"User updated"}]),P.close()):ne.update(f=>[...f,{type:"error",message:"Failed to update user"}])}function C(o,f){o[f].isActive=this.checked,n(0,E)}const A=o=>{n(3,u=o),P.open()};function U(){_.username=this.value,n(4,_)}function p(){_.password=this.value,n(4,_)}function V(){_.confirmPassword=this.value,n(4,_)}function O(o){Te[o?"unshift":"push"](()=>{I=o,n(1,I)})}function H(){u.username=this.value,n(3,u)}const z=(o,f)=>f.uid===o.uid,w=o=>{u.roles.find(f=>f.uid===o.uid)?n(3,u.roles=u.roles.filter(f=>f.uid!==o.uid),u):n(3,u.roles=[...u.roles,{uid:o.uid}],u),console.log(u.roles)};function q(o){Te[o?"unshift":"push"](()=>{P=o,n(2,P)})}return s.$$set=o=>{"data"in o&&n(0,E=o.data)},[E,I,P,u,_,g,B,h,C,A,U,p,V,O,H,z,w,q]}class Je extends Ne{constructor(t){super(),Ie(this,t,Re,Oe,Le,{data:0})}}export{Je as default};
