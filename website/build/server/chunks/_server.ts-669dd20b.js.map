{"version":3,"file":"_server.ts-669dd20b.js","sources":["../../../.svelte-kit/adapter-node/entries/endpoints/api/media/create/_server.ts.js"],"sourcesContent":["import { i as isLogged, h as hasRole } from \"../../../../../chunks/utils.js\";\nimport { e as error, j as json } from \"../../../../../chunks/index.js\";\nimport { p as prisma } from \"../../../../../chunks/prisma.js\";\nconst POST = async ({ request, locals }) => {\n  const { title, content, type, subType, mediaType, mediaUrl } = await request.json();\n  if (!isLogged(locals.user) || !hasRole(\"admin\", locals.user)) {\n    throw error(401, \"Unauthorized\");\n  }\n  if (!title || !content || !type || !subType || !mediaType || !mediaUrl) {\n    throw error(400, \"Missing required fields\");\n  }\n  const { uid } = await prisma.post.create({\n    data: {\n      title,\n      content,\n      type,\n      subType,\n      authorId: locals.user.uid,\n      media: {\n        create: {\n          type: mediaType,\n          url: mediaUrl\n        }\n      }\n    }\n  });\n  return json({\n    success: true,\n    uid\n  });\n};\nexport {\n  POST\n};\n"],"names":[],"mappings":";;;;;;;;AAGK,MAAC,IAAI,GAAG,OAAO,EAAE,OAAO,EAAE,MAAM,EAAE,KAAK;AAC5C,EAAE,MAAM,EAAE,KAAK,EAAE,OAAO,EAAE,IAAI,EAAE,OAAO,EAAE,SAAS,EAAE,QAAQ,EAAE,GAAG,MAAM,OAAO,CAAC,IAAI,EAAE,CAAC;AACtF,EAAE,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,OAAO,EAAE,MAAM,CAAC,IAAI,CAAC,EAAE;AAChE,IAAI,MAAM,KAAK,CAAC,GAAG,EAAE,cAAc,CAAC,CAAC;AACrC,GAAG;AACH,EAAE,IAAI,CAAC,KAAK,IAAI,CAAC,OAAO,IAAI,CAAC,IAAI,IAAI,CAAC,OAAO,IAAI,CAAC,SAAS,IAAI,CAAC,QAAQ,EAAE;AAC1E,IAAI,MAAM,KAAK,CAAC,GAAG,EAAE,yBAAyB,CAAC,CAAC;AAChD,GAAG;AACH,EAAE,MAAM,EAAE,GAAG,EAAE,GAAG,MAAM,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC;AAC3C,IAAI,IAAI,EAAE;AACV,MAAM,KAAK;AACX,MAAM,OAAO;AACb,MAAM,IAAI;AACV,MAAM,OAAO;AACb,MAAM,QAAQ,EAAE,MAAM,CAAC,IAAI,CAAC,GAAG;AAC/B,MAAM,KAAK,EAAE;AACb,QAAQ,MAAM,EAAE;AAChB,UAAU,IAAI,EAAE,SAAS;AACzB,UAAU,GAAG,EAAE,QAAQ;AACvB,SAAS;AACT,OAAO;AACP,KAAK;AACL,GAAG,CAAC,CAAC;AACL,EAAE,OAAO,IAAI,CAAC;AACd,IAAI,OAAO,EAAE,IAAI;AACjB,IAAI,GAAG;AACP,GAAG,CAAC,CAAC;AACL;;;;"}